<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1740px" preserveAspectRatio="none" style="width:815px;height:1740px;" version="1.1" viewBox="0 0 815 1740" width="815px" zoomAndPan="magnify"><defs><filter height="300%" id="fv2b54m28bk8w" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="448.6563" style="stroke: #000000; stroke-width: 2.0;" width="472" x="13" y="71.5938"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="297.8594" style="stroke: #000000; stroke-width: 2.0;" width="452" x="23" y="125.9922"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="452" x="23" y="437.8516"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="463.7891" style="stroke: #000000; stroke-width: 2.0;" width="472" x="13" y="534.25"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="297.8594" style="stroke: #000000; stroke-width: 2.0;" width="452" x="23" y="588.6484"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="90.5313" style="stroke: #000000; stroke-width: 2.0;" width="452" x="23" y="900.5078"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="654.5859" style="stroke: #000000; stroke-width: 2.0;" width="791.5" x="13" y="1012.0391"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="297.8594" style="stroke: #000000; stroke-width: 2.0;" width="444.5" x="350" y="1036.1719"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="444.5" x="350" y="1348.0313"/><rect fill="#FFFFFF" filter="url(#fv2b54m28bk8w)" height="163.9297" style="stroke: #000000; stroke-width: 2.0;" width="771.5" x="23" y="1495.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="85" x2="85" y1="54.5938" y2="1683.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="412" x2="412" y1="54.5938" y2="1683.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="739.5" x2="739.5" y1="54.5938" y2="1683.625"/><rect fill="#FEFECE" filter="url(#fv2b54m28bk8w)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="33" y="3"/><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="60" y="22.9951">Things</text><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="40" y="39.292">(fe80::2222)</text><rect fill="#FEFECE" filter="url(#fv2b54m28bk8w)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="33" y="1682.625"/><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="60" y="1702.6201">Things</text><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="40" y="1718.917">(fe80::2222)</text><rect fill="#FEFECE" filter="url(#fv2b54m28bk8w)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="360" y="3"/><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="379.5" y="22.9951">Directory</text><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="367" y="39.292">(fe80::1111)</text><rect fill="#FEFECE" filter="url(#fv2b54m28bk8w)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="360" y="1682.625"/><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="379.5" y="1702.6201">Directory</text><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="367" y="1718.917">(fe80::1111)</text><rect fill="#FEFECE" filter="url(#fv2b54m28bk8w)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="694.5" y="19.2969"/><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="701.5" y="39.292">Consumer</text><rect fill="#FEFECE" filter="url(#fv2b54m28bk8w)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="694.5" y="1682.625"/><text fill="#000000" font-family="Noto Sans" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="701.5" y="1702.6201">Consumer</text><path d="M13,71.5938 L341,71.5938 L341,108.5938 L331,118.5938 L13,118.5938 L13,71.5938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="448.6563" style="stroke: #000000; stroke-width: 2.0;" width="472" x="13" y="71.5938"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="28" y="84.6606">Register phase:</text><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="245" x="28" y="99.7935">a) The directory discovers Things</text><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="263" x="48" y="114.9263">and retireves TDs from each device</text><path d="M23,125.9922 L183,125.9922 L183,132.9922 L173,142.9922 L23,142.9922 L23,125.9922 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="297.8594" style="stroke: #000000; stroke-width: 2.0;" width="452" x="23" y="125.9922"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="38" y="139.0591">Thing discovery</text><polygon fill="#A80036" points="96.5,175.3906,86.5,179.3906,96.5,183.3906,92.5,179.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="90.5" x2="411.5" y1="179.3906" y2="179.3906"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="102.5" y="159.1919">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="102.5" y="174.3247">"PTR _device._sub._wot._tcp.local"</text><polygon fill="#A80036" points="400.5,219.6563,410.5,223.6563,400.5,227.6563,404.5,223.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="85.5" x2="406.5" y1="223.6563" y2="223.6563"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="92.5" y="203.4575">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="92.5" y="218.5903">"PTR lamp._device._sub._wot._tcp.local"</text><polygon fill="#A80036" points="96.5,263.9219,86.5,267.9219,96.5,271.9219,92.5,267.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="90.5" x2="411.5" y1="267.9219" y2="267.9219"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="102.5" y="247.7231">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="255" x="102.5" y="262.856">"ANY lamp._device._sub._wot._tcp.local"</text><polygon fill="#A80036" points="400.5,323.3203,410.5,327.3203,400.5,331.3203,404.5,327.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="85.5" x2="406.5" y1="327.3203" y2="327.3203"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="92.5" y="291.9888">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="92.5" y="307.1216">"SRV 1 0 10080 lamp.local"</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="92.5" y="322.2544">"TXT retrieve=/Things"</text><polygon fill="#A80036" points="96.5,367.5859,86.5,371.5859,96.5,375.5859,92.5,371.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="90.5" x2="411.5" y1="371.5859" y2="371.5859"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="102.5" y="351.3872">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="102.5" y="366.52">"AAAA lamp.local"</text><polygon fill="#A80036" points="400.5,411.8516,410.5,415.8516,400.5,419.8516,404.5,415.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="85.5" x2="406.5" y1="415.8516" y2="415.8516"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="92.5" y="395.6528">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="92.5" y="410.7856">"AAAA fe80::2222"</text><path d="M23,437.8516 L221,437.8516 L221,444.8516 L211,454.8516 L23,454.8516 L23,437.8516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="452" x="23" y="437.8516"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="38" y="450.9185">Register to directory</text><polygon fill="#A80036" points="96.5,472.1172,86.5,476.1172,96.5,480.1172,92.5,476.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90.5" x2="411.5" y1="476.1172" y2="476.1172"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="102.5" y="471.0513">GET http://lamp.local/Things</text><polygon fill="#A80036" points="400.5,501.25,410.5,505.25,400.5,509.25,404.5,505.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="85.5" x2="406.5" y1="505.25" y2="505.25"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="92.5" y="500.1841">Thing Description: {"@context":...}</text><path d="M13,534.25 L308,534.25 L308,571.25 L298,581.25 L13,581.25 L13,534.25 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="463.7891" style="stroke: #000000; stroke-width: 2.0;" width="472" x="13" y="534.25"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="28" y="547.3169">Register phase:</text><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="236" x="28" y="562.4497">b) Things discover the directory</text><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="235" x="43" y="577.5825">and register TDs by themselves</text><path d="M23,588.6484 L254,588.6484 L254,595.6484 L244,605.6484 L23,605.6484 L23,588.6484 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="297.8594" style="stroke: #000000; stroke-width: 2.0;" width="452" x="23" y="588.6484"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="186" x="38" y="601.7153">Thing directory discovery</text><polygon fill="#A80036" points="400.5,638.0469,410.5,642.0469,400.5,646.0469,404.5,642.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="85.5" x2="406.5" y1="642.0469" y2="642.0469"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="92.5" y="621.8481">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="92.5" y="636.981">"PTR _directory._sub._wot._tcp.local"</text><polygon fill="#A80036" points="96.5,682.3125,86.5,686.3125,96.5,690.3125,92.5,686.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90.5" x2="411.5" y1="686.3125" y2="686.3125"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="102.5" y="666.1138">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="102.5" y="681.2466">"PTR mongo._directory._sub._wot._tcp.local"</text><polygon fill="#A80036" points="400.5,726.5781,410.5,730.5781,400.5,734.5781,404.5,730.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="85.5" x2="406.5" y1="730.5781" y2="730.5781"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="92.5" y="710.3794">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="92.5" y="725.5122">"ANY mongo._directory._sub.wot._tcp.local"</text><polygon fill="#A80036" points="96.5,785.9766,86.5,789.9766,96.5,793.9766,92.5,789.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90.5" x2="411.5" y1="789.9766" y2="789.9766"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="102.5" y="754.645">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="102.5" y="769.7778">"SRV 1 0 80 tdir-mongo.local"</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="303" x="102.5" y="784.9106">"TXT retrieve=/Things register=/Things/register"</text><polygon fill="#A80036" points="400.5,830.2422,410.5,834.2422,400.5,838.2422,404.5,834.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="85.5" x2="406.5" y1="834.2422" y2="834.2422"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="92.5" y="814.0435">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="92.5" y="829.1763">"AAAA tdir-mongo.local"</text><polygon fill="#A80036" points="96.5,874.5078,86.5,878.5078,96.5,882.5078,92.5,878.5078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90.5" x2="411.5" y1="878.5078" y2="878.5078"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="102.5" y="858.3091">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="102.5" y="873.4419">"AAAA fe80::1111"</text><path d="M23,900.5078 L221,900.5078 L221,907.5078 L211,917.5078 L23,917.5078 L23,900.5078 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.5313" style="stroke: #000000; stroke-width: 2.0;" width="452" x="23" y="900.5078"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="38" y="913.5747">Register to directory</text><polygon fill="#A80036" points="400.5,949.9063,410.5,953.9063,400.5,957.9063,404.5,953.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="85.5" x2="406.5" y1="953.9063" y2="953.9063"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="92.5" y="933.7075">POST http://tdir-mongo.local/Things/register</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="92.5" y="948.8403">(payload: Thing Description)</text><polygon fill="#A80036" points="96.5,979.0391,86.5,983.0391,96.5,987.0391,92.5,983.0391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90.5" x2="411.5" y1="983.0391" y2="983.0391"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="102.5" y="977.9731">201 Created</text><path d="M13,1012.0391 L181,1012.0391 L181,1019.0391 L171,1029.0391 L13,1029.0391 L13,1012.0391 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="654.5859" style="stroke: #000000; stroke-width: 2.0;" width="791.5" x="13" y="1012.0391"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="28" y="1025.106">Consume phase:</text><path d="M350,1036.1719 L581,1036.1719 L581,1043.1719 L571,1053.1719 L350,1053.1719 L350,1036.1719 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="297.8594" style="stroke: #000000; stroke-width: 2.0;" width="444.5" x="350" y="1036.1719"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="186" x="365" y="1049.2388">Thing directory discovery</text><polygon fill="#A80036" points="423.5,1085.5703,413.5,1089.5703,423.5,1093.5703,419.5,1089.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="417.5" x2="738.5" y1="1089.5703" y2="1089.5703"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="429.5" y="1069.3716">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="429.5" y="1084.5044">"PTR _directory._sub._wot._tcp.local"</text><polygon fill="#A80036" points="727.5,1129.8359,737.5,1133.8359,727.5,1137.8359,731.5,1133.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="733.5" y1="1133.8359" y2="1133.8359"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="419.5" y="1113.6372">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="419.5" y="1128.77">"PTR mongo._directory._sub._wot._tcp.local"</text><polygon fill="#A80036" points="423.5,1174.1016,413.5,1178.1016,423.5,1182.1016,419.5,1178.1016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="417.5" x2="738.5" y1="1178.1016" y2="1178.1016"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="429.5" y="1157.9028">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="429.5" y="1173.0356">"ANY mongo._directory._sub.wot._tcp.local"</text><polygon fill="#A80036" points="727.5,1233.5,737.5,1237.5,727.5,1241.5,731.5,1237.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="733.5" y1="1237.5" y2="1237.5"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="419.5" y="1202.1685">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="419.5" y="1217.3013">"SRV 1 0 80 tdir-mongo.local"</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="303" x="419.5" y="1232.4341">"TXT retrieve=/Things register=/Things/register"</text><polygon fill="#A80036" points="423.5,1277.7656,413.5,1281.7656,423.5,1285.7656,419.5,1281.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="417.5" x2="738.5" y1="1281.7656" y2="1281.7656"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="429.5" y="1261.5669">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="429.5" y="1276.6997">"AAAA tdir-mongo.local"</text><polygon fill="#A80036" points="727.5,1322.0313,737.5,1326.0313,727.5,1330.0313,731.5,1326.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="733.5" y1="1326.0313" y2="1326.0313"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="419.5" y="1305.8325">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="419.5" y="1320.9653">"AAAA fe80::1111"</text><path d="M350,1348.0313 L529,1348.0313 L529,1355.0313 L519,1365.0313 L350,1365.0313 L350,1348.0313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="444.5" x="350" y="1348.0313"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="134" x="365" y="1361.0981">Query to directory</text><polygon fill="#A80036" points="423.5,1382.2969,413.5,1386.2969,423.5,1390.2969,419.5,1386.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="417.5" x2="738.5" y1="1386.2969" y2="1386.2969"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="429.5" y="1381.231">GET http://tdir-mongo.local/Things</text><polygon fill="#A80036" points="727.5,1411.4297,737.5,1415.4297,727.5,1419.4297,731.5,1415.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="733.5" y1="1415.4297" y2="1415.4297"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="419.5" y="1410.3638">["lamp","otherThing1",...]</text><polygon fill="#A80036" points="423.5,1440.5625,413.5,1444.5625,423.5,1448.5625,419.5,1444.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="417.5" x2="738.5" y1="1444.5625" y2="1444.5625"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="429.5" y="1439.4966">GET http://tdir-mongo.local/Things/lamp</text><polygon fill="#A80036" points="727.5,1469.6953,737.5,1473.6953,727.5,1477.6953,731.5,1473.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="733.5" y1="1473.6953" y2="1473.6953"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="419.5" y="1468.6294">Thing Description: {"@context":...}</text><path d="M23,1495.6953 L235,1495.6953 L235,1502.6953 L225,1512.6953 L23,1512.6953 L23,1495.6953 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="163.9297" style="stroke: #000000; stroke-width: 2.0;" width="771.5" x="23" y="1495.6953"/><text fill="#000000" font-family="Noto Sans" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="167" x="38" y="1508.7622">Interact with the Thing</text><polygon fill="#A80036" points="96.5,1545.0938,86.5,1549.0938,96.5,1553.0938,92.5,1549.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90.5" x2="738.5" y1="1549.0938" y2="1549.0938"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="102.5" y="1528.895">mDNS query</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="102.5" y="1544.0278">"AAAA lamp.local"</text><polygon fill="#A80036" points="727.5,1589.3594,737.5,1593.3594,727.5,1597.3594,731.5,1593.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="85.5" x2="733.5" y1="1593.3594" y2="1593.3594"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="92.5" y="1573.1606">mDNS resp.</text><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="92.5" y="1588.2935">"AAAA fe80::2222"</text><polygon fill="#A80036" points="96.5,1618.4922,86.5,1622.4922,96.5,1626.4922,92.5,1622.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90.5" x2="738.5" y1="1622.4922" y2="1622.4922"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="102.5" y="1617.4263">POST https://lamp.local/on</text><polygon fill="#A80036" points="727.5,1647.625,737.5,1651.625,727.5,1655.625,731.5,1651.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="85.5" x2="733.5" y1="1651.625" y2="1651.625"/><text fill="#000000" font-family="Noto Sans" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="92.5" y="1646.5591">200 OK</text><!--MD5=[57c8a6e545109f0ec542a2ea3eb61df3]
@startuml
skinparam defaultFontName "Noto Sans"
 
participant "Things\n(fe80::2222)" as Thing 
participant "Directory\n(fe80::1111)" as Directory 
participant Consumer

group Register phase:\na) The directory discovers Things\n    and retireves TDs from each device
    group Thing discovery
        Directory - -> Thing : mDNS query\n"PTR _device._sub._wot._tcp.local"
        Thing -> Directory  : mDNS resp.\n"PTR lamp._device._sub._wot._tcp.local"
        Directory - -> Thing : mDNS query\n"ANY lamp._device._sub._wot._tcp.local"
        Thing -> Directory  : mDNS resp.\n"SRV 1 0 10080 lamp.local"\n"TXT retrieve=/Things"
        Directory - -> Thing : mDNS query\n"AAAA lamp.local"
        Thing -> Directory  : mDNS resp.\n"AAAA fe80::2222"
    end
    group Register to directory
        Directory -> Thing  : GET http://lamp.local/Things
        Thing -> Directory  : Thing Description: {"@context":...}
    end
end 
group Register phase:\nb) Things discover the directory\n   and register TDs by themselves
    group Thing directory discovery
        Thing - -> Directory : mDNS query\n"PTR _directory._sub._wot._tcp.local"
        Directory -> Thing  : mDNS resp.\n"PTR mongo._directory._sub._wot._tcp.local"
        Thing - -> Directory : mDNS query\n"ANY mongo._directory._sub.wot._tcp.local"
        Directory -> Thing  : mDNS resp.\n"SRV 1 0 80 tdir-mongo.local"\n"TXT retrieve=/Things register=/Things/register"
        Thing - -> Directory : mDNS query\n"AAAA tdir-mongo.local"
        Directory -> Thing  : mDNS resp.\n"AAAA fe80::1111"
    end
    group Register to directory
        Thing -> Directory  : POST http://tdir-mongo.local/Things/register\n(payload: Thing Description)
        Directory -> Thing  : 201 Created
    end
end
group Consume phase:
    group Thing directory discovery
        Consumer - -> Directory : mDNS query\n"PTR _directory._sub._wot._tcp.local"
        Directory -> Consumer  : mDNS resp.\n"PTR mongo._directory._sub._wot._tcp.local"
        Consumer - -> Directory : mDNS query\n"ANY mongo._directory._sub.wot._tcp.local"
        Directory -> Consumer  : mDNS resp.\n"SRV 1 0 80 tdir-mongo.local"\n"TXT retrieve=/Things register=/Things/register"
        Consumer - -> Directory : mDNS query\n"AAAA tdir-mongo.local"
        Directory -> Consumer  : mDNS resp.\n"AAAA fe80::1111"
    end
    group Query to directory
        Consumer -> Directory  : GET http://tdir-mongo.local/Things
        Directory -> Consumer  : ["lamp","otherThing1",...]
        Consumer -> Directory  : GET http://tdir-mongo.local/Things/lamp
        Directory -> Consumer  : Thing Description: {"@context":...}
    end
    group Interact with the Thing
        Consumer -> Thing      : mDNS query\n"AAAA lamp.local"
        Thing -> Consumer      : mDNS resp.\n"AAAA fe80::2222"
        Consumer -> Thing      : POST https://lamp.local/on
        Thing -> Consumer      : 200 OK
    end
end
@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_242-b08
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>